SELECT *
FROM RIDING;

SELECT CASE WHEN COUNT(*) = 0 THEN 0
            ELSE 1
            END ANSWERCHECK
	FROM PARTICIPATED_MEMBER PM JOIN ANSWER A
	ON PM.P_MEMBER_ID = A.P_MEMBER_ID
	WHERE PM.USER_ID = 82;
    
    
SELECT *
FROM ANSWER;


SELECT *
FROM PARTICIPATED_MEMBER
WHERE USER_ID =83;


SELECT *
FROM PARTICIPATED_MEMBER
ORDER BY 1;



SELECT *
FROM MEMBER
ORDER BY 1;

SELECT *
FROM PROFILE
WHERE USER_ID=84;



INSERT INTO RIDING
VALUES (SEQ_RIDING.NEXTVAL, 84, 0, 0, 0, 0, 0, 0, 0, 0, '몽이콩이모임', '2022-06-16', '2022-06-17', SYSDATE
        , 2, '15', '15', '왕십리', NULL, '30', '30', '몽이몽이', 'ㅁㄴㅇㄹ', '45', '45', '콩이콩이', NULL
        , NULL, '몽이랑콩이는사랑중');

DESC RIDING;

COMMIT;

SELECT COUNT(*)
FROM MEMBER
WHERE USER_ID>84
ORDER BY 1;

SELECT *
FROM RIDING
WHERE RIDING_ID = 13;

UPDATE RIDING
SET END_DATE='2022-06-17';
ROLLBACK;

UPDATE RIDING
SET END_DATE='2022-06-17'
WHERE RIDING_ID=13;

UPDATE RIDING
SET START_DATE ='2022-06-10', END_DATE='2022-06-16'
WHERE RIDING_ID=13;

COMMIT;

DESC RIDING;
SELECT *
FROM PARTICIPATED_MEMBER
WHERE RIDING_ID=13;


-- 모임에 참가시키기
INSERT INTO PARTICIPATED_MEMBER
VALUES(SEQ_PARTICIPATED_MEMBER.NEXTVAL,102,13,SYSDATE);

INSERT INTO PARTICIPATED_MEMBER
VALUES(SEQ_PARTICIPATED_MEMBER.NEXTVAL,84,13,SYSDATE);

COMMIT;

SELECT *
FROM PARTICIPATED_MEMBER PM JOIN RIDING R
ON PM.RIDING_ID = R.RIDING_ID
WHERE USER_ID = 102 ;

UPDATE RIDING
SET START_DATE ='2022-06-15', END_DATE='2022-06-19'
WHERE RIDING_ID=13;

COMMIT;


SELECT TEMP.RIDING_ID
		FROM
		(
		    SELECT ROW_NUMBER() OVER (ORDER BY R.END_DATE DESC) AS ROW1,R.*
		    FROM RIDING R JOIN PARTICIPATED_MEMBER PM
		    ON R.RIDING_ID = PM.RIDING_ID
		    WHERE SYSDATE <= END_DATE AND PM.USER_ID = 102
		)TEMP
		WHERE TEMP.ROW1 = 1;



SELECT PM.USER_ID AS USER_ID
		    ,P.NICKNAME AS NICKNAME
		FROM PARTICIPATED_MEMBER PM JOIN PROFILE P
		ON PM.USER_ID = P.USER_ID
		WHERE RIDING_ID = 13;
        
        
SELECT CASE WHEN COUNT(*) = 0 THEN 0
            ELSE 1
            END ANSWERCHECK
	FROM PARTICIPATED_MEMBER PM JOIN ANSWER A
	ON PM.P_MEMBER_ID = A.P_MEMBER_ID
	WHERE PM.USER_ID = 102;
    
    
SELECT PM.USER_ID AS USER_ID
		    ,P.NICKNAME AS NICKNAME
		FROM PARTICIPATED_MEMBER PM JOIN PROFILE P
		ON PM.USER_ID = P.USER_ID
		WHERE RIDING_ID = 13;

SELECT *
FROM PARTICIPATED_MEMBER;

SELECT ANSWER_ID
FROM
(
SELECT  ROWNUM AS ANSROW,ANSWER_ID
		FROM PARTICIPATED_MEMBER PM JOIN ANSWER A
		ON PM.P_MEMBER_ID = A.P_MEMBER_ID
		WHERE PM.USER_ID = 102
)TEMP
WHERE TEMP.ANSROW=1;

SELECT *
FROM ANSWER;


SELECT *
FROM CHECK_ATTENDANCE;






SELECT *
FROM ANSWER_DETAIL_LEADERSHIP;
-->없음


--=================================평가 테이블 삭제
DELETE
FROM ANSWER_DETAIL;

-- 9 삭제

COMMIT;

DELETE
FROM ANSWER_ATTENDANCE;
-->많음
-->11개 삭제

COMMIT;

DELETE
FROM CHECK_ATTENDANCE;
--33개 삭제
COMMIT;


DELETE
FROM ANSWER;
--22개 삭제

COMMIT;
--=================================평가 테이블 삭제


--리더십 
SELECT *
FROM ANSWER_DETAIL_LEADERSHIP;


--=================================평가 테이블 삭제

SELECT ANSWER_ID
		FROM
		(
		SELECT  ROWNUM AS ANSROW,ANSWER_ID
				FROM PARTICIPATED_MEMBER PM JOIN ANSWER A
				ON PM.P_MEMBER_ID = A.P_MEMBER_ID
				WHERE PM.USER_ID = 84
		)TEMP
		WHERE TEMP.ANSROW=1;


SELECT CHECK_ATTE_ID, USER_ID
		FROM CHECK_ATTENDANCE CA JOIN PARTICIPATED_MEMBER PM
		ON CA.P_MEMBER_ID = PM.P_MEMBER_ID
		WHERE PM.USER_ID = 102;




SELECT P_MEMBER_ID
		FROM PARTICIPATED_MEMBER
		WHERE USER_ID = 102;

INSERT INTO ANSWER (ANSWER_ID , P_MEMBER_ID , SUBMIT_DATE)
		VALUES(SEQ_ANSWER.NEXTVAL, 40,SYSDATE);
        







--------------------------------------------------------------------------------
SELECT *
FROM RIDING;


SELECT *
FROM PARTICIPATED_MEMBER;

SELECT *
FROM MEMBER
ORDER BY USER_ID;







-- 모임에 참가시키기
INSERT INTO PARTICIPATED_MEMBER
VALUES(SEQ_PARTICIPATED_MEMBER.NEXTVAL,102,16,SYSDATE);

-- 모임에 참가시키기
INSERT INTO PARTICIPATED_MEMBER
VALUES(SEQ_PARTICIPATED_MEMBER.NEXTVAL,84,16,SYSDATE);

INSERT INTO PARTICIPATED_MEMBER
VALUES(SEQ_PARTICIPATED_MEMBER.NEXTVAL,105,16,SYSDATE);

COMMIT;

SELECT *
FROM RIDING;












        